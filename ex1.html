<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Estimating cascade rates from advective structure functions &mdash; Oceans SF 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="_static/nbsphinx-code-cells.css" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=01f34227"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Structure functions for multiple snapshots or observations with bootstrapping" href="ex2.html" />
    <link rel="prev" title="Examples" href="examples.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Oceans SF
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview of Oceans SF</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation instructions</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="examples.html">Examples</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Estimating cascade rates from advective structure functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Load-the-dataset-generated-with-GeophysicalFlows.jl">Load the dataset generated with GeophysicalFlows.jl</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Calculate-advective-velocity-structure-functions">Calculate advective velocity structure functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Calculating-scalar-based-structure-functions-and-traditional-structure-functions">Calculating scalar-based structure functions and traditional structure functions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ex2.html">Structure functions for multiple snapshots or observations with bootstrapping</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="modules.html">Functions</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Oceans SF</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="examples.html">Examples</a></li>
      <li class="breadcrumb-item active">Estimating cascade rates from advective structure functions</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/ex1.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Estimating-cascade-rates-from-advective-structure-functions">
<h1>Estimating cascade rates from advective structure functions<a class="headerlink" href="#Estimating-cascade-rates-from-advective-structure-functions" title="Link to this heading"></a></h1>
<p>This example will guide you through each step necessary to estimate energy and enstrophy cascade rates from a 2D simulation of surface ocean velocity.</p>
<p><strong>General procedure:</strong></p>
<ol class="arabic simple">
<li><p>Load a dataset generated with GeophysicalFlows.jl</p></li>
<li><p>Format the dataset</p></li>
<li><p>Calculate velocity-based and scalar-based structure functions for the zonal and meridional directions as a function of separation distance</p></li>
<li><p>Estimate energy and enstrophy cascade rates from the structure functions</p></li>
<li><p>Plot the cascade rates in each direction as a function of separation distance</p></li>
</ol>
<section id="Load-the-dataset-generated-with-GeophysicalFlows.jl">
<h2>Load the dataset generated with GeophysicalFlows.jl<a class="headerlink" href="#Load-the-dataset-generated-with-GeophysicalFlows.jl" title="Link to this heading"></a></h2>
<p>We will use <code class="docutils literal notranslate"><span class="pre">h5py</span></code> to load a <code class="docutils literal notranslate"><span class="pre">.jld2</span></code> file, the output from <code class="docutils literal notranslate"><span class="pre">GeophysicalFlows.jl</span></code>, a numerical ocean simulator written in Julia.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import h5py

f = h5py.File(&#39;sample_data/2layer_128.jld2&#39;, &#39;r&#39;)
grid = f[&#39;grid&#39;]
snapshots = f[&#39;snapshots&#39;]

# Initialize the grid of x and y coordinates
x = grid[&#39;x&#39;][()]
y = grid[&#39;y&#39;][()]

# Grab the top layer and final snapshot of the simulation for u, v, and q
u = snapshots[&#39;u&#39;][&#39;20050&#39;][0]
v = snapshots[&#39;v&#39;][&#39;20050&#39;][0]
q = snapshots[&#39;q&#39;][&#39;20050&#39;][0]
</pre></div>
</div>
</div>
<p>Make a couple of quick plots to see the velocity fields.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import matplotlib.pyplot as plt

fig, (ax1, ax2) = plt.subplots(1,2, sharex=True, sharey=True, figsize=(8,3))
p1 = ax1.pcolormesh(x,y,u, cmap=&#39;RdBu&#39;,vmin=-5,vmax=5)
p2 = ax2.pcolormesh(x,y,v, cmap=&#39;RdBu&#39;,vmin=-5,vmax=5)
fig.colorbar(p1,label=&#39;u-velocity [m/s]&#39;)
fig.colorbar(p2, label=&#39;v-velocity [m/s]&#39;)
ax1.set_xlabel(&#39;x [m]&#39;)
ax2.set_xlabel(&#39;x [m]&#39;)
ax1.set_ylabel(&#39;y [m]&#39;)
ax2.set_ylabel(&#39;y [m]&#39;)
plt.tight_layout()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/ex1_5_0.png" src="_images/ex1_5_0.png" />
</div>
</div>
</section>
<section id="Calculate-advective-velocity-structure-functions">
<h2>Calculate advective velocity structure functions<a class="headerlink" href="#Calculate-advective-velocity-structure-functions" title="Link to this heading"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import oceans_sf as ocsf

sf = ocsf.generate_structure_functions(u, v, x, y)
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>fig, (ax1) = plt.subplots()


ax1.semilogx(sf[&#39;x-diffs&#39;], sf[&#39;SF_advection_velocity_zonal&#39;],label=r&#39;$\delta u\cdot\delta A_u$ zonal&#39;,color=&#39;k&#39;)
ax1.semilogx(sf[&#39;y-diffs&#39;], sf[&#39;SF_advection_velocity_meridional&#39;], label=r&#39;$\delta u\cdot\delta A_u$ meridional&#39;,
             color=&#39;k&#39;,linestyle=&#39;dotted&#39;)

ax1.set_ylabel(r&quot;Structure function [s$^{-3}$]&quot;)
ax1.set_xlabel(r&quot;Separation distance [m]&quot;)
ax1.set_xlim(3e-2,3e0)
ax1.legend()
plt.hlines(0,3e-2,3e0,color=&#39;k&#39;,linestyle=&#39;dashed&#39;,alpha=0.3)
ax1.tick_params(direction=&quot;in&quot;, which=&quot;both&quot;)
ax1.xaxis.get_ticklocs(minor=True)
ax1.minorticks_on()
plt.title(&#39;Advective velocity structure functions&#39;)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0.5, 1.0, &#39;Advective velocity structure functions&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/ex1_8_1.png" src="_images/ex1_8_1.png" />
</div>
</div>
<p>For advective velocity-based structure functions, multiply by -1/2 to get the energy cascade rate.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>fig, (ax1) = plt.subplots()

ax1.semilogx(sf[&#39;x-diffs&#39;], -sf[&#39;SF_advection_velocity_zonal&#39;]/2,
             label=r&#39;$-\frac{1}{2} \delta u\cdot\delta A_u$ zonal&#39;,color=&#39;k&#39;)
ax1.semilogx(sf[&#39;y-diffs&#39;], -sf[&#39;SF_advection_velocity_meridional&#39;]/2,
             label=r&#39;$-\frac{1}{2} \delta u\cdot\delta A_u$ meridional&#39;,color=&#39;k&#39;,
             linestyle=&#39;dotted&#39;)

ax1.set_ylabel(r&quot;Energy flux [m$^2$ s$^{-3}$]&quot;)
ax1.set_xlabel(r&quot;Separation distance [m]&quot;)
ax1.set_xlim(3e-2,3e0)
ax1.legend()
plt.hlines(0,3e-2,3e0,color=&#39;k&#39;,linestyle=&#39;dashed&#39;,alpha=0.3)
ax1.tick_params(direction=&quot;in&quot;, which=&quot;both&quot;)
ax1.xaxis.get_ticklocs(minor=True)
ax1.minorticks_on()
plt.title(&#39;Advective velocity structure functions&#39;)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0.5, 1.0, &#39;Advective velocity structure functions&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/ex1_10_1.png" src="_images/ex1_10_1.png" />
</div>
</div>
</section>
<section id="Calculating-scalar-based-structure-functions-and-traditional-structure-functions">
<h2>Calculating scalar-based structure functions and traditional structure functions<a class="headerlink" href="#Calculating-scalar-based-structure-functions-and-traditional-structure-functions" title="Link to this heading"></a></h2>
<p>We can repeat the above steps with additional inputs to calculate advective structure functions from scalar fields as well as traditional nth order structure functions. Here we will calculate the 3rd order traditional structure functions since these can be related to cascade rates.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[53]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>sf_all = ocsf.generate_structure_functions(u, v, x, y, scalar=q, traditional_order=3)
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[54]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>fig, (ax1) = plt.subplots()


ax1.semilogx(sf_all[&#39;x-diffs&#39;], sf_all[&#39;SF_advection_scalar_zonal&#39;],label=r&#39;$\delta \omega\cdot\delta A_{\omega}$ zonal&#39;,color=&#39;k&#39;)
ax1.semilogx(sf_all[&#39;y-diffs&#39;], sf_all[&#39;SF_advection_scalar_meridional&#39;], label=r&#39;$\delta \omega\cdot\delta A_{\omega}$ meridional&#39;,
             color=&#39;k&#39;,linestyle=&#39;dotted&#39;)

ax1.set_ylabel(r&quot;Structure function [s$^{-3}$]&quot;)
ax1.set_xlabel(r&quot;Separation distance [m]&quot;)
ax1.set_xlim(3e-2,3e0)
ax1.legend()
plt.hlines(0,3e-2,3e0,color=&#39;k&#39;,linestyle=&#39;dashed&#39;,alpha=0.3)
ax1.tick_params(direction=&quot;in&quot;, which=&quot;both&quot;)
ax1.xaxis.get_ticklocs(minor=True)
ax1.minorticks_on()
plt.title(&#39;Advective vorticity structure functions&#39;)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[54]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0.5, 1.0, &#39;Advective vorticity structure functions&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/ex1_13_1.png" src="_images/ex1_13_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[55]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>fig, (ax1) = plt.subplots()


ax1.semilogx(sf_all[&#39;x-diffs&#39;], sf_all[&#39;SF_traditional_velocity_zonal&#39;],label=r&#39;$\delta u_z \delta u_z \delta u_z$ zonal&#39;,color=&#39;k&#39;)
ax1.semilogx(sf_all[&#39;y-diffs&#39;], sf_all[&#39;SF_traditional_velocity_meridional&#39;], label=r&#39;$\delta u_m \delta u_m \delta u_m$ meridional&#39;,
             color=&#39;k&#39;,linestyle=&#39;dotted&#39;)

ax1.set_ylabel(r&quot;Structure function [s$^{-3}$]&quot;)
ax1.set_xlabel(r&quot;Separation distance [m]&quot;)
ax1.set_xlim(3e-2,3e0)
ax1.legend()
plt.hlines(0,3e-2,3e0,color=&#39;k&#39;,linestyle=&#39;dashed&#39;,alpha=0.3)
ax1.tick_params(direction=&quot;in&quot;, which=&quot;both&quot;)
ax1.xaxis.get_ticklocs(minor=True)
ax1.minorticks_on()
plt.title(&#39;Traditional velocity structure functions&#39;)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[55]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0.5, 1.0, &#39;Traditional velocity structure functions&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/ex1_14_1.png" src="_images/ex1_14_1.png" />
</div>
</div>
<p><strong>Note: The current method for calculating the traditional vorticity structure function is not recommended and we instead suggest a mixed structure function (in development).</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[56]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>fig, (ax1) = plt.subplots()


ax1.semilogx(sf_all[&#39;x-diffs&#39;], sf_all[&#39;SF_traditional_scalar_zonal&#39;],label=r&#39;$\delta \omega \delta \omega \delta \omega$ zonal&#39;,color=&#39;k&#39;)
ax1.semilogx(sf_all[&#39;y-diffs&#39;], sf_all[&#39;SF_traditional_scalar_meridional&#39;], label=r&#39;$\delta \omega \delta \omega \delta \omega$ meridional&#39;,
             color=&#39;k&#39;,linestyle=&#39;dotted&#39;)

ax1.set_ylabel(r&quot;Structure function [s$^{-3}$]&quot;)
ax1.set_xlabel(r&quot;Separation distance [m]&quot;)
ax1.set_xlim(3e-2,3e0)
ax1.legend()
plt.hlines(0,3e-2,3e0,color=&#39;k&#39;,linestyle=&#39;dashed&#39;,alpha=0.3)
ax1.tick_params(direction=&quot;in&quot;, which=&quot;both&quot;)
ax1.xaxis.get_ticklocs(minor=True)
ax1.minorticks_on()
plt.title(&#39;Traditional vorticity structure functions&#39;)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[56]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0.5, 1.0, &#39;Traditional vorticity structure functions&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/ex1_16_1.png" src="_images/ex1_16_1.png" />
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="examples.html" class="btn btn-neutral float-left" title="Examples" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="ex2.html" class="btn btn-neutral float-right" title="Structure functions for multiple snapshots or observations with bootstrapping" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Cassidy Wagner.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>